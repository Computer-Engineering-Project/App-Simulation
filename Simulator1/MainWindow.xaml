<Window x:Class="Simulator1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Simulator1"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:prism="http://prismlibrary.com/"
        xmlns:view="clr-namespace:Simulator1.View"
        xmlns:viewmodels="clr-namespace:Simulator1.ViewModel"
        mc:Ignorable="d"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        Name="mainwindow"
        Title="Software Simulator"
        Height="450"
        Width="800">
    <Grid>
        <materialDesign:DialogHost x:Name="container"
                                   DialogContentUniformCornerRadius="20"
                                   BorderBrush="{DynamicResource MaterialDesignDivider}"
                                   IsOpen="{Binding IsDialogOpen}">
            <materialDesign:DialogHost.DialogContent>
                <Viewbox HorizontalAlignment="Stretch"
                         VerticalAlignment="Top"
                         Stretch="Uniform"
                         StretchDirection="Both">
                    <ContentControl Content="{Binding CurrentModuleViewModel}">
                        <ContentControl.Resources>
                            <DataTemplate DataType="{x:Type viewmodels:ModuleParameterViewModel}">
                                <view:ModuleParameter />
                            </DataTemplate>
                        </ContentControl.Resources>
                    </ContentControl>
                </Viewbox>

            </materialDesign:DialogHost.DialogContent>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0"
                          Background="AliceBlue">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"></ColumnDefinition>
                            <ColumnDefinition Width="10*"></ColumnDefinition>
                            <ColumnDefinition Width="4*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <Image Source="./static/img/logo.png"
                                   Width="50"
                                   Height="50"
                                   Margin="20 0 0 0"
                                   Stretch="Uniform" />
                        </Grid>
                        <Grid Grid.Column="2">
                            <StackPanel Orientation="Horizontal"
                                        Margin="5 0 5 0">
                                <Button Width="100"
                                        Content="HISTORY"
                                        Background="Wheat"
                                        IsEnabled="True"
                                        Style="{StaticResource MaterialDesignFlatLightBgButton}"
                                        Margin="0 0 20 0"
                                        Command="{Binding LoadHistoryCommand}"
                                        ToolTip="MaterialDesignFlatLightButton" />
                                <Button Width="70"
                                        Content="STOP"
                                        Background="OrangeRed"
                                        IsEnabled="True"
                                        Style="{StaticResource MaterialDesignFlatLightBgButton}"
                                        Margin="0 0 20 0"
                                        ToolTip="MaterialDesignFlatLightButton" />
                                <Button Width="70"
                                        Background="Green"
                                        Content="RUN"
                                        IsEnabled="True"
                                        Style="{StaticResource MaterialDesignFlatLightBgButton}"
                                        ToolTip="MaterialDesignFlatDarkButton" />
                            </StackPanel>
                        </Grid>

                    </Grid>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition Width="3"></ColumnDefinition>
                            <ColumnDefinition Width="3*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30"></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0"
                                       Margin="10 10 10 0"
                                       Padding="0 0 0 0"
                                       FontSize="15">Module</TextBlock>
                            <Grid Grid.Row="1"
                                  Margin="0 20 0 0">
                                <!--Thêm code cho button-->
                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition Height="3"></RowDefinition>
                                    <RowDefinition Height="150"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <ItemsControl ItemsSource="{Binding Ports}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Button materialDesign:ButtonAssist.CornerRadius="10"
                                                        Style="{StaticResource MaterialDesignOutlinedDarkButton}"
                                                        Background="Wheat"
                                                        Margin="10 0 10 10"
                                                        Content="{Binding}">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="Click">
                                                            <prism:InvokeCommandAction Command="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.OpenDialogCommand}"
                                                                                       CommandParameter="{Binding}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </Button>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Grid>

                                <GridSplitter Grid.Row="1"
                                              HorizontalAlignment="Stretch"></GridSplitter>
                                <Grid Grid.Row="2">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="40"></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                    </Grid.RowDefinitions>
                                </Grid>
                            </Grid>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      HorizontalAlignment="Stretch"></GridSplitter>
                        <Grid Grid.Column="2"
                              x:Name="workspace">
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition Height="3"></RowDefinition>
                                <RowDefinition Height="150"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <ItemsControl ItemsSource="{Binding ModuleObjects}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <Canvas AllowDrop="True"
                                                    x:Name="canvas" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <view:testModule DropModuleCommand="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.autoSaveCommand}">
                                                <i:Interaction.Triggers>
                                                    <i:EventTrigger EventName="MouseRightButtonDown">
                                                        <prism:InvokeCommandAction Command="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.UpdateModuleCommand }"
                                                                                   CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContentPresenter}, Path=Tag}" />
                                                    </i:EventTrigger>
                                                </i:Interaction.Triggers>
                                            </view:testModule>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                    <ItemsControl.ItemContainerStyle>
                                        <Style TargetType="ContentPresenter">
                                            <Setter Property="Canvas.Left"
                                                    Value="{Binding x, Mode=TwoWay}" />
                                            <Setter Property="Canvas.Top"
                                                    Value="{Binding y, Mode=TwoWay}" />
                                            <Setter Property="Tag"
                                                    Value="{Binding port, Mode=TwoWay}" />
                                        </Style>
                                    </ItemsControl.ItemContainerStyle>
                                </ItemsControl>
                            </Grid>
                            <GridSplitter Grid.Row="1"
                                          HorizontalAlignment="Stretch"></GridSplitter>
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                    <ColumnDefinition Width="*"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0"
                                        BorderBrush="#CDDBE3"
                                        BorderThickness="0,0,1,0">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="40" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0"
                                                   Text="Information"
                                                   Margin="10 10 10 0"
                                                   Padding="0 0 0 0"
                                                   FontSize="15"
                                                   FontWeight="Bold" />

                                        <!--Table-->
                                        <TextBlock>ahha</TextBlock>
                                        <Grid>
                                            <DataGrid ItemsSource="{Binding DataObject}"
                                                      AutoGenerateColumns="false">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Event"
                                                                        Binding="{Binding Id}" />
                                                    <DataGridTextColumn Header="Source"
                                                                        Binding="{Binding Source}" />
                                                    <DataGridTextColumn Header="Data"
                                                                        Binding="{Binding Data}" />
                                                    <DataGridTextColumn Header="Delay Time"
                                                                        Binding="{Binding DelayTime}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </Grid>


                                    </Grid>
                                </Border>
                                <Border Grid.Column="1"
                                        BorderBrush="#CDDBE3"
                                        BorderThickness="0,0,1,0">
                                    <TextBlock Text="Column 2"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center" />
                                </Border>

                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </materialDesign:DialogHost>
    </Grid>
</Window>
